<div class="tenant-orders-container">
  <div class="header">
    <h1>
      <mat-icon>assignment</mat-icon>
      Order Queue
    </h1>
    <button mat-raised-button color="primary" (click)="refreshOrders()">
      <mat-icon>refresh</mat-icon>
      Refresh
    </button>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-section">
    <mat-card>
      <mat-card-content>
        <div class="loading-content">
          <mat-icon class="loading-icon">hourglass_empty</mat-icon>
          <h3>Loading orders...</h3>
          <p>Fetching the latest order queue from the system.</p>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Error State -->
  <div *ngIf="!loading && error" class="error-section">
    <mat-card>
      <mat-card-content>
        <div class="error-content">
          <mat-icon class="error-icon">error_outline</mat-icon>
          <h3>Error Loading Orders</h3>
          <p>{{ error }}</p>
          <button mat-raised-button color="primary" (click)="loadOrders()">
            <mat-icon>refresh</mat-icon>
            Try Again
          </button>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Orders Content WITHOUT tabs - testing if tabs cause the issue -->
  <div *ngIf="!loading && !error" class="orders-content">
    <h2>New Orders</h2>
    <div *ngIf="newOrders$ | async as newOrders">
      <div *ngIf="newOrders.length === 0" class="empty-state">
        <mat-icon>inbox</mat-icon>
        <h3>No New Orders</h3>
        <p>All orders have been processed. Great work!</p>
      </div>
      
      <div *ngIf="newOrders.length > 0" class="orders-grid">
        <div class="orders-summary">
          <mat-icon>info</mat-icon>
          <span>{{ newOrders.length }} new order(s) waiting for processing</span>
        </div>
        
        <!-- Back to working simple cards with status update functionality -->
        <mat-card *ngFor="let order of newOrders; trackBy: trackByOrderId" class="simple-order-card">
          <mat-card-content>
            <h3>Order #{{ order.OrderId?.substring(0, 8) }}</h3>
            <p><strong>Status:</strong> {{ order.Status }}</p>
            <p><strong>Customer:</strong> {{ order.CustomerId }}</p>
            <p><strong>Total:</strong> ${{ order.TotalAmount }}</p>
            <p><strong>Items:</strong> {{ order.OrderItems?.length || 0 }}</p>
            <p><strong>Item Names:</strong> {{ getOrderItemNames(order) }}</p>
            
            <!-- Add status update functionality -->
            <div class="status-actions" *ngIf="order.Status === 'Submitted' || order.Status === 'Processing'">
              <button mat-button color="primary" 
                      *ngIf="order.Status === 'Submitted'"
                      (click)="updateOrderStatus(order, 'Processing')">
                Start Processing
              </button>
              <button mat-button color="accent" 
                      *ngIf="order.Status === 'Processing'"
                      (click)="updateOrderStatus(order, 'Completed')">
                Mark Completed
              </button>
              <button mat-button color="warn" 
                      *ngIf="order.Status === 'Submitted'"
                      (click)="updateOrderStatus(order, 'Rejected')">
                Reject
              </button>
              <button mat-button 
                      (click)="viewCustomer(order.CustomerId)">
                View Customer
              </button>
            </div>
          </mat-card-content>
        </mat-card>
      </div>
    </div>
  </div>
</div>