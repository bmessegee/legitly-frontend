<div class="wrapper">
    <!-- Package Header Section -->
    <div class="package-header" *ngIf="formConfig">
        <div class="package-info">
            <div class="package-title">{{formConfig.title}}</div>
            <div class="package-subtitle" *ngIf="formConfig.subtitle">{{formConfig.subtitle}}</div>
            <div class="package-price">${{getServiceCost() | number:'1.0-0'}}</div>
            <div class="package-description">{{formConfig.instructions}}</div>
        </div>
        
        <!-- Package Features -->
        <div class="package-features" *ngIf="formConfig.features">
            <h4>What's Included:</h4>
            <ul class="features-list">
                <li *ngFor="let feature of formConfig.features" class="feature-item">
                    <mat-icon class="check-icon">check_circle</mat-icon>
                    <span>{{feature}}</span>
                </li>
            </ul>
        </div>

        <!-- Tier Comparison Button -->
        <div class="package-actions" *ngIf="isLLCPackage() && !isAddonService()">
            <button 
                mat-stroked-button 
                color="primary" 
                (click)="showComparison = !showComparison"
                class="compare-button">
                <mat-icon>compare_arrows</mat-icon>
                {{showComparison ? 'Hide' : 'Compare'}} Packages
            </button>
        </div>
    </div>

    <!-- Package Comparison Section -->
    <div class="package-comparison" *ngIf="showComparison && isLLCPackage()">
        <h3>Choose Your Package</h3>
        <div class="comparison-grid">
            <div class="package-card" 
                 *ngFor="let pkg of llcPackages" 
                 [class.selected]="selectedForm === pkg.id"
                 [class.popular]="pkg.popular"
                 (click)="switchPackage(pkg.id)">
                <div class="popular-badge" *ngIf="pkg.popular">Most Popular</div>
                <div class="package-card-header">
                    <h4>{{pkg.title}}</h4>
                    <div class="package-card-price">${{pkg.cost | number:'1.0-0'}}</div>
                    <p class="package-card-subtitle">{{pkg.subtitle}}</p>
                </div>
                <div class="package-card-features">
                    <ul>
                        <li *ngFor="let feature of pkg.features" class="package-feature">
                            <mat-icon class="mini-check">check</mat-icon>
                            <span>{{feature}}</span>
                        </li>
                    </ul>
                </div>
                <button 
                    mat-raised-button 
                    [color]="selectedForm === pkg.id ? 'primary' : ''"
                    [disabled]="selectedForm === pkg.id"
                    class="select-package-btn">
                    {{selectedForm === pkg.id ? 'Selected' : 'Select Package'}}
                </button>
            </div>
        </div>
    </div>

    <!-- Form Section -->
    <div class="form-section" *ngIf="formConfig">
        <div class="form-header">
            <h3>Complete Your {{formConfig.title}}</h3>
            <p class="form-description">Please provide the following information for your LLC formation</p>
        </div>
        
        <form [formGroup]="form" (ngSubmit)="onCheckout()">
            <formly-form [form]="form" [fields]="fields" [model]="model"></formly-form>
            <div class="form-actions">
                <div class="checkout-summary">
                    <div class="summary-line">
                        <span>{{formConfig.title}}</span>
                        <span class="summary-price">${{getServiceCost() | number:'1.0-0'}}</span>
                    </div>
                    <div class="summary-total">
                        <span>Total</span>
                        <span class="total-price">${{getServiceCost() | number:'1.0-0'}}</span>
                    </div>
                </div>
                <button 
                    mat-raised-button 
                    color="primary" 
                    type="submit" 
                    [disabled]="!form.valid"
                    class="checkout-button">
                    <mat-icon>shopping_cart</mat-icon>
                    Checkout - ${{getServiceCost() | number:'1.0-0'}}
                </button>
            </div>
        </form>
    </div>
    
    <div *ngIf="!formConfig" class="loading-form">
        <mat-icon class="loading-icon">hourglass_empty</mat-icon>
        Loading package details...
    </div>
</div>
