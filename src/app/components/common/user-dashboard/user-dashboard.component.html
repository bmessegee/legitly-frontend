<div class="dashboard-wrapper">
  <div class="dashboard-header">
    <h2>Available Services</h2>
    <p>Choose the perfect package for your business formation needs</p>
  </div>
  
  <!-- LLC Packages Section -->
  <div class="llc-packages-section" *ngIf="authService.isCustomerUser()">
    <h3>LLC Formation Packages</h3>
    <div class="packages-grid">
      @for (card of cards | async; track card) {
        <div class="enhanced-dashboard-card" 
             *ngIf="authService.isInRole(card.displayRoles) && isLLCPackage(card.id)"
             [class.popular]="card.id === 'llc-complete'"
             (click)='routeTo(card.actionLink, card.actionQuery)'>
          <div class="popular-badge" *ngIf="card.id === 'llc-complete'">Most Popular</div>
          
          <div class="card-header">
            <mat-icon class="package-icon">{{card.icon}}</mat-icon>
            <h4 class="card-title">{{card.title}}</h4>
            <p class="card-subtitle">{{getPackageSubtitle(card.id)}}</p>
            <div class="card-price">{{card.actionDisplay}}</div>
          </div>
          
          <div class="card-content">
            <p class="card-description">{{card.description}}</p>
            <ul class="feature-preview" *ngIf="getPackageFeatures(card.id)">
              <li *ngFor="let feature of getPackageFeatures(card.id).slice(0, 3)">
                <mat-icon class="check-mini">check_circle</mat-icon>
                <span>{{feature}}</span>
              </li>
              <li class="more-features" *ngIf="getPackageFeatures(card.id).length > 3">
                <span>+ {{getPackageFeatures(card.id).length - 3}} more features</span>
              </li>
            </ul>
          </div>
          
          <div class="card-actions">
            <button mat-raised-button color="primary" class="select-package-btn">
              Get Started
              <mat-icon>arrow_forward</mat-icon>
            </button>
          </div>
        </div>
      }
    </div>
  </div>
  
  <!-- Add-on Services Section -->
  <div class="addon-services-section" *ngIf="authService.isCustomerUser()">
    <h3>Additional Services</h3>
    <div class="addon-services-grid">
      @for (card of cards | async; track card) {
        <div class="addon-service-card" 
             *ngIf="authService.isInRole(card.displayRoles) && isAddonService(card.id)"
             (click)='routeTo(card.actionLink, card.actionQuery)'>
          <div class="addon-service-header">
            <mat-icon class="addon-service-icon">{{card.icon}}</mat-icon>
            <h4>{{card.title}}</h4>
          </div>
          <p class="addon-service-description">{{card.description}}</p>
          <button mat-stroked-button color="primary" class="addon-service-btn">
            {{card.actionDisplay}}
            <mat-icon>arrow_forward</mat-icon>
          </button>
        </div>
      }
    </div>
  </div>

  <!-- My Services Section -->
  <div class="my-services-section">
    <h3 *ngIf="authService.isCustomerUser()">My Services</h3>
    <h3 *ngIf="!authService.isCustomerUser()">Management Tools</h3>
    <div class="my-services-grid">
      @for (card of cards | async; track card) {
        <div class="my-service-card" 
             *ngIf="authService.isInRole(card.displayRoles) && isMyService(card.id)"
             (click)='routeTo(card.actionLink, card.actionQuery)'>
          <div class="my-service-header">
            <mat-icon class="my-service-icon">{{card.icon}}</mat-icon>
            <h4>{{card.title}}</h4>
          </div>
          <p class="my-service-description">{{card.description}}</p>
          <button mat-stroked-button color="primary" class="my-service-btn">
            {{card.actionDisplay}}
            <mat-icon>arrow_forward</mat-icon>
          </button>
        </div>
      }
    </div>
  </div>
</div>
